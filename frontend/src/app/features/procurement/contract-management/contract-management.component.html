<div class="contract-management" *ngIf="!loading; else loadingState">
  <div class="header-section">
    <div>
      <h1 class="page-title">Contract Management</h1>
      <p class="header-subtitle">Approved supplier bids ready to move into contracting</p>
    </div>
    <button class="btn-create" (click)="createContract()">
      <span class="icon">+</span>
      Create Contract
    </button>
  </div>

  <div class="stats-container">
    <div class="stat-card">
      <label class="stat-label">Approved Bids</label>
      <div class="stat-value">{{ summary.approved }}</div>
    </div>
    <div class="stat-card">
      <label class="stat-label">Total Value</label>
      <div class="stat-value">{{ summary.totalValue | currency }}</div>
    </div>
    <div class="stat-card">
      <label class="stat-label">Records Loaded</label>
      <div class="stat-value">{{ summary.total }}</div>
    </div>
  </div>

  <div class="table-section">
    <div class="table-header">
      <h2>Approved supplier bids</h2>
      <div class="search-box">
        <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" placeholder="Search by reference, title, or supplier" (input)="onSearch($event)" />
      </div>
    </div>

    <div class="table-wrapper" *ngIf="filteredContracts.length > 0; else emptyState">
      <table class="contracts-table">
        <thead>
          <tr>
            <th>Reference</th>
            <th>Title</th>
            <th>Supplier</th>
            <th>Bid Amount</th>
            <th>Submitted</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let contract of filteredContracts">
            <td class="contract-number">{{ contract.referenceNumber }}</td>
            <td class="title">{{ contract.title }}</td>
            <td>{{ contract.supplierName }}</td>
            <td class="value">{{ contract.bidAmount | currency: contract.currency }}</td>
            <td>{{ contract.submittedAtUtc | date: 'mediumDate' }}</td>
            <td>
              <span class="status-badge" [ngClass]="getStatusClass(contract.evaluationStatus)">
                {{ contract.evaluationStatus }}
              </span>
            </td>
            <td class="actions">
              <button class="btn-icon" (click)="viewContract(contract)" title="View">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
              </button>
              <button class="btn-icon" (click)="editContract(contract)" title="Manage contract">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<ng-template #emptyState>
  <div class="no-results">
    <p>No approved bids are ready for contract management.</p>
    <p class="muted">Approve a supplier bid to begin the contracting process.</p>
  </div>
</ng-template>

<ng-template #loadingState>
  <div class="loading-state">Loading contract-ready bids...</div>
</ng-template>
